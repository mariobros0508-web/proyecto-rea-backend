{% extends 'rea_api/base.html' %}
{% load static %}
{% load widget_tweaks %}  <-- ¬°MOVEMOS ESTA L√çNEA AQU√ç!

{% block title %}{{ titulo_form }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4 text-center">{{ titulo_form }}</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    {{ form.non_field_errors }}

    <form method="POST" enctype="multipart/form-data" class="p-4 border rounded bg-light shadow-sm">
        {% csrf_token %}
        
        <div class="mb-3">
            <label for="{{ form.titulo.id_for_label }}" class="form-label">T√≠tulo</label>
            {{ form.titulo|add_class:"form-control" }}
            {{ form.titulo.errors }}
        </div>
        
        <div class="mb-3">
            <label for="{{ form.descripcion.id_for_label }}" class="form-label">Descripci√≥n</label>
            {{ form.descripcion|add_class:"form-control" }}
            {{ form.descripcion.errors }}
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.idioma.id_for_label }}" class="form-label">Idioma</label>
                {{ form.idioma|add_class:"form-control" }}
                {{ form.idioma.errors }}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.licencia.id_for_label }}" class="form-label">Licencia</label>
                {{ form.licencia|add_class:"form-select" }}
                {{ form.licencia.errors }}
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.nivel.id_for_label }}" class="form-label">Nivel Educativo</label>
                {{ form.nivel|add_class:"form-select" }}
                {{ form.nivel.errors }}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.categoria.id_for_label }}" class="form-label">Categor√≠a</label>
                {{ form.categoria|add_class:"form-select" }}
                {{ form.categoria.errors }}
            </div>
        </div>
        
        <div class="mb-3">
            <label for="{{ form.archivo_pdf.id_for_label }}" class="form-label">Subir archivo PDF</label>
            {{ form.archivo_pdf }} 
            <div class="form-text">
                Al subir un archivo PDF, se actualizar√° autom√°ticamente el campo de URL.
            </div>
            {{ form.archivo_pdf.errors }}
        </div>

        <div class="mb-3">
            <label for="{{ form.etiquetas.id_for_label }}" class="form-label">Etiquetas</label>
            <div class="form-check">
                {{ form.etiquetas }}
            </div>
            {{ form.etiquetas.errors }}
        </div>

        {% if form.instance.url_acceso %}
        <div class="mb-3">
            <label class="form-label">URL del recurso (actual)</label>
            <input type="text" value="{{ form.instance.url_acceso }}" class="form-control" readonly>
        </div>
        {% endif %}

        <div class="d-flex justify-content-between">
            <a href="{% url 'recurso_list' %}" class="btn btn-secondary">‚Üê Volver</a>
            <button type="submit" class="btn btn-primary">
                üíæ Guardar Recurso
            </button>
        </div>
    </form>
</div>
{% endblock %}

{% block extra_js %}
{% comment %} Eliminamos el load de aqu√≠ ya que lo movimos arriba {% endcomment %}
{% endblock %}